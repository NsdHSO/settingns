#!/bin/sh

# Emoji mapping
EMOJI_MAPPER() {
    case $1 in
        feat*)    echo "🎸" ;;
        fix*)     echo "🛠️" ;;
        docs*)    echo "📝" ;;
        style*)   echo "🎨" ;;
        refactor*) echo "👷" ;;
        test*)    echo "🐳" ;;
        chore*)   echo "🌻" ;;
        perf*)    echo "🚀" ;;
        revert*)  echo "⏪" ;;
        *)        echo "" ;;
    esac
}

# Process commit message
COMMIT_MSG_FILE=$1
COMMIT_MSG=$(cat "$COMMIT_MSG_FILE")

# Extract commit type from first line
FIRST_LINE=$(echo "$COMMIT_MSG" | head -n 1)
COMMIT_TYPE=$(echo "$FIRST_LINE" | cut -d ':' -f 1)

# Get matching emoji
EMOJI=$(EMOJI_MAPPER "$COMMIT_TYPE")

# Add emoji if found
if [ -n "$EMOJI" ]; then
    # Format: "type: emoji message"
    NEW_MSG=$(echo "$COMMIT_MSG" | sed "1s/$COMMIT_TYPE:/$COMMIT_TYPE: $EMOJI/")
    echo "$NEW_MSG" > "$COMMIT_MSG_FILE"
fi